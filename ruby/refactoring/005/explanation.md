# 出題意図

この問題は、メール通知システムのリファクタリングを通じて、DSL（ドメイン特化言語）の設計とパターンベースのアプローチを学習することを目的としています。

## 適用されたテーマ

1. **DSL（ドメイン特化言語）** - メタプログラミングRuby
   - メールテンプレート定義のための内部DSLを作成
   - instance_evalを使用してブロック内でDSLメソッドを実行

2. **ビルダーパターン** - Design Patterns
   - TemplateBuilderとEmailBuilderでオブジェクトの構築をカプセル化
   - 複雑なオブジェクトの生成プロセスを管理

3. **テンプレートメソッドパターン** - Design Patterns
   - メールの構造は同じで、内容だけが異なる
   - 共通のアルゴリズムを定義し、詳細をテンプレートで変更

4. **条件分岐をポリモーフィズムに置き換える** - Refactoring
   - メールタイプごとのif-elsif連鎖を排除
   - データ構造とオブジェクトで管理

5. **単一責任の原則 (SRP)** - プリンシプル オブ プログラミング
   - EmailNotifier: メール送信の調整
   - EmailTemplates: テンプレートの管理
   - EmailBuilder: メールオブジェクトの構築
   - EmailTemplate: テンプレートのレンダリング

6. **オープンクローズド原則 (OCP)** - Code Complete
   - 新しいメールタイプの追加が容易
   - 既存コードを変更せずに拡張可能

7. **表現力豊かなDSL** - プリンシプル オブ プログラミング (PIE)
   - テンプレート定義が読みやすく、意図が明確
   - ビジネスロジックがコードに直接反映

8. **テンプレート変数の補間** - メタプログラミングRuby
   - {{variable}}形式のテンプレート変数を実装
   - 動的なコンテンツ生成を可能に

9. **digメソッドの活用** - メタプログラミングRuby
   - ネストしたハッシュへの安全なアクセス
   - nilチェックの繰り返しを回避

10. **コンポジションによる設計** - Practical Software Engineering
    - 小さなクラスを組み合わせて機能を実現
    - 各クラスがテストしやすく、再利用可能