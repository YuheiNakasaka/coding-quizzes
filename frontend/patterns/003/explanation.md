# 出題意図

この問題は以下の能力を測定することを目的としています：

1. **イベント伝播メカニズムの理解**
   - イベントバブリングの仕組み
   - キャプチャフェーズとバブリングフェーズの違い
   - イベントパスの計算

2. **DOMイベントモデルの深い理解**
   - target vs currentTargetの違い
   - stopPropagation()の実装
   - イベントフェーズの管理

3. **複雑なデータ構造の操作**
   - WeakMapを使った効率的なリスナー管理
   - 親子関係のトラバーサル
   - フェーズごとのリスナー分離

4. **フレームワーク開発の視点**
   - 低レベルAPIの設計と実装
   - ブラウザAPIの再実装による理解深化
   - パフォーマンスを考慮した設計

この実装は、ブラウザのイベントシステムやReactのSynthetic Eventの
基礎となる概念であり、フロントエンドフレームワークの
内部動作を理解する上で重要です。