# 出題意図

この問題は以下の能力を測定することを目的としています：

1. **メモリ管理の理解**
   - イベントリスナーによるメモリリークの認識
   - WeakMapを使った弱参照の活用
   - 購読者ベースのクリーンアップ戦略

2. **高度なObserver Pattern実装**
   - 購読者単位での管理
   - 複数の管理構造を使った効率的な実装
   - バッチクリーンアップ機能

3. **実践的な問題解決力**
   - SPA（Single Page Application）でよくある問題への対処
   - コンポーネントのライフサイクル管理
   - リソースの適切な解放

4. **データ構造の適切な選択**
   - WeakMapによる自動ガベージコレクション
   - オブジェクトと配列の組み合わせによる効率的な検索

この実装パターンは、ReactのuseEffectのクリーンアップ関数や、
RxJSのunsubscribeメカニズムの基礎となる概念であり、
大規模なフロントエンドアプリケーションでのメモリ管理において重要です。